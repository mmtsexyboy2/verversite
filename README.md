# ور ور سایت (Ver Ver Site)

"ور ور سایت" یک پلتفرم انجمن آنلاین است که با هدف ایجاد فضایی برای گفتگو و تبادل نظر طراحی شده است. این پروژه با الهام از سادگی و کارایی پلتفرم‌هایی مانند یوتیوب و با تمرکز بر ویژگی‌های تعاملی مشابه Reddit و نی‌نی‌سایت توسعه داده می‌شود.

## ساختار پروژه

این پروژه به صورت یک مونوریپو (monorepo) سازماندهی شده و شامل دو بخش اصلی است:

*   `backend/`: اپلیکیشن سمت سرور که با Node.js و Express.js توسعه داده شده و مسئولیت مدیریت منطق کسب‌وکار، APIها و ارتباط با دیتابیس PostgreSQL را بر عهده دارد.
*   `frontend/`: اپلیکیشن سمت کاربر که با Next.js (React) توسعه داده شده و رابط کاربری وب‌سایت را فراهم می‌کند.

## پیش‌نیازهای سیستم

قبل از شروع، مطمئن شوید که نرم‌افزارهای زیر روی سیستم شما نصب شده باشند:

*   **Node.js:** نسخه 18.x (LTS) یا بالاتر پیشنهاد می‌شود. می‌توانید از [وب‌سایت رسمی Node.js](https://nodejs.org/) آن را دانلود و نصب کنید.
*   **PostgreSQL:** یک سیستم مدیریت دیتابیس رابطه‌ای. برای نصب و راه‌اندازی به [مستندات PostgreSQL](https://www.postgresql.org/docs/) مراجعه کنید. پس از نصب، باید یک دیتابیس و یک کاربر برای این پروژه ایجاد کنید.
*   **Git:** برای کلون کردن ریپازیتوری پروژه.

## راه‌اندازی Backend

1.  **رفتن به پوشه backend:**
    ```bash
    cd backend
    ```

2.  **نصب وابستگی‌ها:**
    ```bash
    npm install
    ```

3.  **ایجاد و تنظیم فایل `.env`:**
    یک فایل به نام `.env` در ریشه پوشه `backend/` ایجاد کرده و متغیرهای محیطی زیر را با مقادیر مناسب خود پر کنید:

    ```env
    # PostgreSQL Database Configuration
    DB_HOST=localhost
    DB_PORT=5432
    DB_USER=your_db_user         # نام کاربری دیتابیس شما
    DB_PASSWORD=your_db_password   # رمز عبور دیتابیس شما
    DB_NAME=verversite_db        # نام دیتابیسی که ایجاد کرده‌اید

    # Google OAuth Credentials
    GOOGLE_CLIENT_ID=your_google_client_id.apps.googleusercontent.com
    GOOGLE_CLIENT_SECRET=your_google_client_secret

    # Application URLs
    API_BASE_URL=http://localhost:3000  # آدرس پایه سرور بک‌اند شما
    APP_BASE_URL=http://localhost:3001  # آدرس پایه سرور فرانت‌اند شما (برای ریدایرکت‌های OAuth)

    # Security
    JWT_SECRET=your_strong_jwt_secret_key          # یک کلید امن و طولانی برای امضای توکن‌ها
    SESSION_SECRET=your_strong_session_secret_key  # یک کلید امن برای نشست‌ها
    ```
    *   **نکته مهم:** مقادیر `GOOGLE_CLIENT_ID` و `GOOGLE_CLIENT_SECRET` را باید از Google Cloud Console برای پروژه خود دریافت کنید. `API_BASE_URL` باید با پورتی که بک‌اند روی آن اجرا می‌شود (معمولاً 3000) و `APP_BASE_URL` با پورتی که فرانت‌اند روی آن اجرا می‌شود (معمولاً 3001) مطابقت داشته باشد.

4.  **اجرای Migrationهای دیتابیس:**
    این دستور جداول لازم را در دیتابیس شما ایجاد می‌کند.
    ```bash
    npx knex migrate:latest
    ```

5.  **اجرای سرور Backend:**
    ```bash
    npm start
    ```
    سرور بک‌اند به طور پیش‌فرض روی پورت 3000 (یا پورتی که در `process.env.PORT` تنظیم کرده‌اید) شروع به کار خواهد کرد.
    (برای توسعه، می‌توانید از `nodemon server.js` استفاده کنید اگر `nodemon` را نصب کرده‌اید).

## راه‌اندازی Frontend

1.  **رفتن به پوشه frontend:**
    (از ریشه پروژه)
    ```bash
    cd frontend
    ```

2.  **نصب وابستگی‌ها:**
    ```bash
    npm install
    ```

3.  **ایجاد و تنظیم فایل `.env.local`:**
    یک فایل به نام `.env.local` در ریشه پوشه `frontend/` ایجاد کرده و متغیر محیطی زیر را تنظیم کنید:

    ```env
    NEXT_PUBLIC_API_BASE_URL=http://localhost:3000/api
    ```
    *   **نکته مهم:** این آدرس باید به مسیر پایه APIهای بک‌اند شما اشاره کند. اگر بک‌اند شما روی پورت دیگری یا دامنه دیگری اجرا می‌شود، این مقدار را متناسب با آن تغییر دهید.

4.  **اجرای سرور Frontend:**
    ```bash
    npm run dev
    ```
    سرور توسعه فرانت‌اند معمولاً روی پورت 3001 شروع به کار خواهد کرد.

## تست قابلیت‌های اولیه

پس از راه‌اندازی موفقیت‌آمیز هر دو سرور بک‌اند و فرانت‌اند:

1.  مرورگر خود را باز کرده و به آدرس فرانت‌اند (معمولاً `http://localhost:3001`) بروید.
    *   باید لیستی از تاپیک‌ها (اگر از قبل تاپیکی در دیتابیس وجود داشته باشد یا توسط فید اولیه ایجاد شود) را در صفحه اصلی مشاهده کنید.
    *   بارگذاری بی‌نهایت (Infinite scroll) باید با اسکرول به پایین صفحه، تاپیک‌های بیشتری را (در صورت وجود) بارگذاری کند.
2.  روی دکمه **"Login"** در نوبار کلیک کنید.
3.  با استفاده از حساب کاربری گوگل خود وارد شوید. شما باید به صفحه گوگل هدایت شده و پس از ورود موفق، به برنامه بازگردید.
4.  پس از ورود موفق، باید نام کاربری و آواتار خود را در نوبار مشاهده کنید و دکمه "Login" به "Logout" و "New Topic" تغییر کرده باشد.
5.  **روی نام کاربری نویسنده یک تاپیک (در صفحه اصلی یا صفحه تاپیک) کلیک کنید تا به صفحه پروفایل او بروید.**
    *   ***در صفحه پروفایل، باید اطلاعات کاربر، لیست تاپیک‌های او، و تعداد دنبال‌کنندگان/دنبال‌شوندگان را مشاهده کنید.***
    *   ***اگر پروفایل متعلق به کاربر دیگری است، باید بتوانید او را دنبال (Follow) یا آنفالو (Unfollow) کنید و تغییرات در تعداد دنبال‌کنندگان و ظاهر دکمه را مشاهده نمایید.***
6.  **از صفحه اصلی، روی عنوان یک تاپیک کلیک کنید تا به صفحه آن تاپیک بروید.**
    *   در صفحه تاپیک، باید جزئیات کامل تاپیک (عنوان، متن، نویسنده، تاریخ) را مشاهده کنید.
    *   باید بتوانید تاپیک را لایک کنید ***و تغییر در تعداد لایک‌ها و ظاهر دکمه را ببینید.***
    *   باید بتوانید برای تاپیک کامنت ارسال کنید. ***کامنت‌های تودرتو باید با تورفتگی مناسب نمایش داده شوند.***
    *   ***باید بتوانید کامنت‌ها را لایک یا حذف کنید (اگر مالک کامنت یا ادمین باشید) و تغییرات را مشاهده نمایید.***
    *   اگر مالک تاپیک یا ادمین باشید، باید بتوانید خود تاپیک را نیز حذف کنید.
7.  روی دکمه **"New Topic"** کلیک کنید.
8.  فرم ایجاد تاپیک ظاهر می‌شود. فیلدهای **"Title"** و **"Body"** را پر کنید. (سایر فیلدها مانند دسته‌بندی و URL تصویر در این مرحله اختیاری هستند).
9.  روی دکمه **"Create Topic"** کلیک کنید.
10. اگر همه چیز به درستی کار کند، باید به صفحه تاپیک جدید هدایت شوید.

## سناریوهای تست پیشنهادی توسط کاربر

در ادامه لیستی از سناریوهای پیشنهادی برای تست دستی قابلیت‌های مختلف پلتفرم ارائه شده است:

1.  **راه‌اندازی و محیط اولیه**
    *   بررسی صحت نصب تمامی پیش‌نیازها (Node.js, PostgreSQL, Git).
    *   کلون کردن صحیح ریپازیتوری.
    *   اجرای موفقیت‌آمیز `npm install` در هر دو پوشه `backend` و `frontend`.
    *   ایجاد و تنظیم صحیح فایل‌های `.env` (در بک‌اند) و `.env.local` (در فرانت‌اند) با مقادیر معتبر.
    *   اجرای موفقیت‌آمیز migrationهای دیتابیس (`npx knex migrate:latest`).
    *   اجرای همزمان و بدون خطای سرورهای بک‌اند (`npm start` در `backend`) و فرانت‌اند (`npm run dev` در `frontend`).
    *   مشاهده صفحه اصلی سایت در مرورگر بدون خطا.

2.  **احراز هویت کاربر (ورود با گوگل)**
    *   کلیک روی دکمه "Login" و هدایت صحیح به صفحه ورود گوگل.
    *   ورود موفق با یک حساب کاربری گوگل معتبر.
    *   هدایت صحیح به صفحه اصلی سایت پس از ورود.
    *   نمایش نام کاربری و آواتار کاربر وارد شده در نوبار.
    *   تغییر دکمه "Login" به "Logout" و نمایش دکمه "New Topic".
    *   تلاش برای ورود با حساب گوگل نامعتبر یا انصراف از ورود (و بررسی رفتار سیستم).
    *   تست Logout و اطمینان از خروج صحیح کاربر (عدم نمایش نام کاربری، تغییر دکمه‌ها به حالت اولیه).
    *   تلاش برای دسترسی به صفحات نیازمند لاگین (مانند ایجاد تاپیک) پس از Logout (باید به صفحه لاگین هدایت شود).

3.  **ایجاد تاپیک (New Topic)**
    *   کلیک روی دکمه "New Topic" (کاربر باید لاگین کرده باشد).
    *   نمایش صحیح فرم ایجاد تاپیک با فیلدهای عنوان (Title) و متن (Body).
    *   تلاش برای ایجاد تاپیک با فیلدهای خالی (و مشاهده پیام خطای مناسب).
    *   ایجاد تاپیک با عنوان و متن معتبر.
    *   بررسی ایجاد تاپیک با انتخاب دسته‌بندی (Category) و افزودن URL تصویر (Image URL) (در صورت پیاده‌سازی).
    *   هدایت به صفحه تاپیک جدید پس از ایجاد موفقیت‌آمیز.
    *   بررسی نمایش صحیح اطلاعات تاپیک جدید در صفحه آن (عنوان، متن، نویسنده، تاریخ).
    *   بررسی نمایش تاپیک جدید در لیست تاپیک‌ها در صفحه اصلی (یا فید کاربر).

4.  **نمایش لیست تاپیک‌ها (صفحه اصلی/فید)**
    *   بارگذاری صفحه اصلی و مشاهده لیست تاپیک‌ها.
    *   بررسی نمایش اطلاعات کلیدی هر تاپیک در لیست (عنوان، نویسنده، تعداد لایک/کامنت، تاریخ، دسته‌بندی).
    *   تست بارگذاری بی‌نهایت (Infinite Scroll): با اسکرول به پایین، تاپیک‌های قدیمی‌تر باید به صورت خودکار بارگذاری شوند.
    *   تست فیلتر کردن تاپیک‌ها بر اساس دسته‌بندی (در صورت پیاده‌سازی قابلیت فیلتر).
    *   تست مرتب‌سازی تاپیک‌ها (مثلاً بر اساس جدیدترین، محبوب‌ترین) (در صورت پیاده‌سازی قابلیت مرتب‌سازی).
    *   بررسی عملکرد صحیح در صورت عدم وجود تاپیک (نمایش پیام مناسب).

5.  **نمایش صفحه تاپیک تکی (Single Topic Page)**
    *   کلیک روی عنوان یک تاپیک از لیست برای ورود به صفحه آن.
    *   نمایش کامل جزئیات تاپیک (عنوان، متن کامل، نویسنده، آواتار نویسنده، تاریخ ایجاد، دسته‌بندی، تصویر تاپیک).
    *   بررسی نمایش تعداد لایک‌ها و کامنت‌ها.
    *   اگر مالک تاپیک یا ادمین هستید، بررسی وجود دکمه حذف تاپیک.
    *   تلاش برای حذف تاپیک (به عنوان مالک/ادمین) و بررسی حذف موفقیت‌آمیز و هدایت به صفحه مناسب (مثلاً صفحه اصلی).
    *   تلاش برای حذف تاپیک (به عنوان کاربر غیرمالک/غیراادمین) و بررسی عدم نمایش دکمه حذف یا عدم موفقیت عملیات.

6.  **لایک کردن تاپیک‌ها و کامنت‌ها**
    *   لایک کردن یک تاپیک (به عنوان کاربر لاگین کرده) و مشاهده افزایش تعداد لایک‌ها و تغییر ظاهر دکمه (مثلاً به حالت "Liked").
    *   آنلایک کردن همان تاپیک و مشاهده کاهش تعداد لایک‌ها و بازگشت دکمه به حالت اولیه.
    *   تلاش برای لایک کردن تاپیک بدون لاگین (باید به صفحه لاگین هدایت شود یا پیام مناسب نمایش داده شود).
    *   لایک کردن یک کامنت (به عنوان کاربر لاگین کرده) و مشاهده افزایش تعداد لایک‌های کامنت و تغییر ظاهر دکمه.
    *   آنلایک کردن همان کامنت و مشاهده تغییرات متناظر.

7.  **سیستم کامنت‌گذاری**
    *   ارسال یک کامنت جدید برای یک تاپیک (به عنوان کاربر لاگین کرده).
    *   بررسی نمایش کامنت جدید در لیست کامنت‌های تاپیک با اطلاعات صحیح (متن، نویسنده، تاریخ).
    *   ارسال یک پاسخ (Reply) به یک کامنت موجود.
    *   بررسی نمایش صحیح پاسخ به صورت تودرتو (nested) و با تورفتگی مناسب زیر کامنت والد.
    *   ارسال پاسخ به یک پاسخ دیگر (تست عمق بیشتر تودرتویی).
    *   حذف یکی از کامنت‌های خود و بررسی حذف آن از لیست.
    *   تلاش برای حذف کامنت کاربر دیگر (به عنوان کاربر عادی) و بررسی عدم موفقیت.
    *   تلاش برای حذف کامنت کاربر دیگر (به عنوان ادمین) و بررسی حذف موفقیت‌آمیز (در صورت پیاده‌سازی سطح دسترسی ادمین برای حذف کامنت).
    *   تلاش برای ارسال کامنت خالی و مشاهده پیام خطای مناسب.
    *   تلاش برای ارسال کامنت بدون لاگین (باید به صفحه لاگین هدایت شود یا پیام مناسب داده شود).

8.  **صفحه پروفایل کاربر و قابلیت دنبال کردن (Follow/Unfollow)**
    *   کلیک روی نام کاربری نویسنده یک تاپیک یا کامنت برای ورود به صفحه پروفایل او.
    *   مشاهده اطلاعات کاربر در صفحه پروفایل (نام کاربری، آواتار، تعداد تاپیک‌های ایجاد شده، تعداد دنبال‌کنندگان و دنبال‌شوندگان).
    *   مشاهده لیست تاپیک‌های ایجاد شده توسط آن کاربر.
    *   اگر پروفایل متعلق به کاربر دیگری است و شما لاگین هستید:
        *   کلیک روی دکمه "Follow" و بررسی افزایش تعداد دنبال‌کنندگان آن کاربر و تغییر دکمه به "Unfollow".
        *   رفرش صفحه و اطمینان از باقی ماندن وضعیت "Unfollow".
        *   کلیک روی دکمه "Unfollow" و بررسی کاهش تعداد دنبال‌کنندگان و تغییر دکمه به "Follow".
    *   بررسی عدم نمایش دکمه Follow/Unfollow در صفحه پروفایل خودتان.
    *   تلاش برای دنبال کردن کاربر بدون لاگین (باید به صفحه لاگین هدایت شود).

9.  **موارد عمومی و تجربه کاربری (UX)**
    *   بررسی ریسپانسیو بودن صفحات مختلف در اندازه‌های مختلف مرورگر (دسکتاپ، تبلت، موبایل).
    *   بررسی سرعت بارگذاری صفحات اصلی و صفحات تاپیک.
    *   بررسی خوانایی متون و وضوح تصاویر.
    *   بررسی عدم وجود خطاهای جاوااسکریپت در کنسول مرورگر.
    *   بررسی پیوندهای داخلی (مانند لینک به پروفایل، لینک به تاپیک) و اطمینان از صحت عملکرد آنها.
    *   تجربه کاربری کلی در هنگام ناوبری در سایت.

این مستندات اولیه به شما کمک می‌کند تا بخش‌های اصلی پروژه را راه‌اندازی و تست کنید. با پیشرفت پروژه، این فایل `README.md` نیز تکمیل‌تر خواهد شد.
